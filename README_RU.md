````md
# üö¢ –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –≤—ã–∂–∏–≤–∞–µ–º–æ—Å—Ç–∏ –Ω–∞ Titanic ‚Äî End-to-End ML + Streamlit + Docker

ML-–ø—Ä–æ–µ–∫—Ç –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –≤—ã–∂–∏–≤–∞–µ–º–æ—Å—Ç–∏ –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤ Titanic —Å **–ø–æ–ª–Ω—ã–º –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã–º –ø–∞–π–ø–ª–∞–π–Ω–æ–º**:

EDA ‚Üí Feature Engineering ‚Üí —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∏—á ‚Üí Optuna tuning (XGBoost) ‚Üí **–∫–∞—Å—Ç–æ–º–Ω—ã–π end-to-end –ø–∞–π–ø–ª–∞–π–Ω (raw ‚Üí processed ‚Üí model)** ‚Üí Streamlit app ‚Üí Docker.

---

## üîó Live Demo
**Streamlit app:** https://titanic-ml-optuna.streamlit.app/

---

## ‚ú® Highlights
- ‚úÖ Feature engineering + —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è:
  - **–ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ:** chi-square, —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ survival rate
  - **–ß–∏—Å–ª–æ–≤—ã–µ:** Mann‚ÄìWhitney U, Welch t-test, Cohen‚Äôs d
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏:
  - Pearson / Spearman (—á–∏—Å–ª–æ–≤—ã–µ), Cram√©r‚Äôs V (–∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ)
- ‚úÖ –û—Ç–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:
  - greedy selection + L1 (Lasso) + permutation importance
- ‚úÖ Optuna tuning + —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª—É—á—à–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ **–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–æ—Ä–æ–≥–∞ –ø–æ–¥ F1**
- ‚úÖ Sanity check: **shuffle target ‚Üí ROC-AUC ‚âà 0.5** (–ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —É—Ç–µ—á–∫–∏ / ‚Äú—É–¥–∞—á–Ω—ã–π —Å–ø–ª–∏—Ç‚Äù)
- ‚úÖ –î–µ–ø–ª–æ–π:
  - Streamlit app + Docker + Docker Compose

---

## üìå –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
- [–û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞](#-–æ–±–∑–æ—Ä-–ø—Ä–æ–µ–∫—Ç–∞)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è](#-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è)
- [–†–µ–∑—É–ª—å—Ç–∞—Ç—ã](#-—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã)
- [–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç (–ø–æ—à–∞–≥–æ–≤–æ)](#-–∫–∞–∫-—ç—Ç–æ-—Ä–∞–±–æ—Ç–∞–µ—Ç-–ø–æ—à–∞–≥–æ–≤–æ)
- [–ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ](#Ô∏è-–∑–∞–ø—É—Å–∫-–ª–æ–∫–∞–ª—å–Ω–æ)
- [–ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker](#-–∑–∞–ø—É—Å–∫-—á–µ—Ä–µ–∑-docker)
- [–ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã](#-–∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã)
- [Roadmap](#-roadmap)
- [–õ–∏—Ü–µ–Ω–∑–∏—è](#-–ª–∏—Ü–µ–Ω–∑–∏—è)

---

## üìñ –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞
**–¶–µ–ª—å:** –ø–æ—Å—Ç—Ä–æ–∏—Ç—å end-to-end, –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã–π ML-–ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è `Survived (0/1)`, –ø–æ–∫—Ä—ã–≤–∞—é—â–∏–π –ø–æ–ª–Ω—ã–π –ø—É—Ç—å:
raw –¥–∞–Ω–Ω—ã–µ ‚Üí –æ–±—Ä–∞–±–æ—Ç–∫–∞ ‚Üí –æ–±—É—á–µ–Ω–∏–µ ‚Üí —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ ‚Üí –∏–Ω—Ñ–µ—Ä–µ–Ω—Å ‚Üí UI.

**–ü–æ–¥—Ö–æ–¥ –∫ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—é:**
- Baseline –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ–∏—á: **Logistic Regression**
- –§–∏–Ω–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å: **XGBoost** (—Ö–æ—Ä–æ—à–∏–π –±–∞–ª–∞–Ω—Å —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ –∫–∞—á–µ—Å—Ç–≤–∞)

**–û—Å–Ω–æ–≤–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞ –≤–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∏—á–∞–º–∏:** **ROC-AUC**  
**–§–∏–Ω–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è:** Accuracy / Precision / Recall / F1

**–°—Ö–µ–º–∞ –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞:**
- Holdout split: `train_test_split(..., stratify=y, random_state=...)`
- Cross-validation: `StratifiedKFold` + `cross_val_predict` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è out-of-fold –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π

---

## üß± –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
```text
.
‚îú‚îÄ artifacts/
‚îÇ  ‚îú‚îÄ model_data/
‚îÇ  ‚îî‚îÄ features.json
‚îú‚îÄ data/
‚îÇ  ‚îú‚îÄ raw/
‚îÇ  ‚îî‚îÄ processed/
‚îú‚îÄ notebooks/
‚îÇ  ‚îú‚îÄ 01_EDA_feature_engineering.ipynb
‚îÇ  ‚îú‚îÄ 02_modelling_optuna.ipynb
‚îÇ  ‚îî‚îÄ 03_check_pipelines_performance.ipynb
‚îú‚îÄ src/
‚îÇ  ‚îú‚îÄ custom_pipeline.py
‚îÇ  ‚îú‚îÄ train_custom.py
‚îÇ  ‚îî‚îÄ predict.py
‚îú‚îÄ app.py
‚îú‚îÄ Dockerfile
‚îú‚îÄ docker-compose.yml
‚îú‚îÄ .dockerignore
‚îî‚îÄ .gitignore
````

**–ü–∞–ø–∫–∏ —Å –¥–∞–Ω–Ω—ã–º–∏:**

* `data/raw` ‚Äî –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (raw)
* `data/processed` ‚Äî –¥–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ feature engineering

**–ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã:**

* `artifacts/` ‚Äî –≤—Å—ë –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏: –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ñ–∏—á, –ª—É—á—à–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –ø–æ—Ä–æ–≥–∏ –∏ —Ç.–¥.

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

> –ú–µ—Ç—Ä–∏–∫–∏ –ø–æ—Å—á–∏—Ç–∞–Ω—ã –Ω–∞ —Å—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–º train/test split –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω—ã —Å—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–π K-Fold –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–µ–π (—á–µ—Ä–µ–∑ `cross_val_predict`) –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–ª–∞—Å—Å–æ–≤ –∏ —Å–Ω–∏–∂–µ–Ω–∏—è –¥–∏—Å–ø–µ—Ä—Å–∏–∏.

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–æ–≤

**Full custom pipeline (raw ‚Üí processed ‚Üí model):**

* accuracy: **0.9057**
* precision: **0.8686**
* recall: **0.8889**
* f1: **0.8786**

**Standard pipeline (processed + standard preprocessing):**

* accuracy: **0.8945**
* precision: **0.8543**
* recall: **0.8743**
* f1: **0.8642**

**–†–∞–∑–Ω–∏—Ü–∞ (custom ‚àí standard):**

* accuracy: **+0.0112**
* precision: **+0.0143**
* recall: **+0.0146**
* f1: **+0.0145**

‚úÖ –ò—Ç–æ–≥: **full custom pipeline –ª—É—á—à–µ**, –ø–æ—ç—Ç–æ–º—É –æ–Ω —Å–æ—Ö—Ä–∞–Ω—ë–Ω –∫–∞–∫ —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ.

---

## üß† –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç (–ø–æ—à–∞–≥–æ–≤–æ)

### 1) EDA + Feature Engineering + Feature Selection

–°–Ω–∞—á–∞–ª–∞ ‚Äî exploratory analysis, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å:

* —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —á–∏—Å–ª–æ–≤—ã—Ö/–∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö —Ñ–∏—á
* —Ä–∞–∑–ª–∏—á–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É `Survived=1` –∏ `Survived=0`

–ó–∞—Ç–µ–º ‚Äî —É–≥–ª—É–±–ª—ë–Ω–Ω—ã–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ (–µ—Å–ª–∏ —Å–∏–≥–Ω–∞–ª —Å–ª–∞–±—ã–π ‚Üí –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–ª—Å—è –∫ feature engineering):

**–ü—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö —Ñ–∏—á**

* Chi-square test
* –°—Ä–∞–≤–Ω–µ–Ω–∏–µ survival rate

**–ü—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è —á–∏—Å–ª–æ–≤—ã—Ö —Ñ–∏—á**

* Mann‚ÄìWhitney U (—É—Å—Ç–æ–π—á–∏–≤ –∫ –Ω–µ-–Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏ –∏ –≤—ã–±—Ä–æ—Å–∞–º)
* Welch t-test (—Ä–∞–∑–Ω—ã–µ –¥–∏—Å–ø–µ—Ä—Å–∏–∏)
* Cohen‚Äôs d (—Ä–∞–∑–º–µ—Ä —ç—Ñ—Ñ–µ–∫—Ç–∞)

–î–∞–ª–µ–µ ‚Äî —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏:

* Pearson / Spearman –¥–ª—è —á–∏—Å–ª–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
* Cram√©r‚Äôs V –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö

–§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç–±–æ—Ä —Ñ–∏—á —Å–æ—á–µ—Ç–∞–ª baseline **Logistic Regression** + **ROC-AUC**:

* Greedy selection (–¥–æ–±–∞–≤–ª—è–ª —Ñ–∏—á–∏ –ø–æ –æ–¥–Ω–æ–π –∏ –æ—Å—Ç–∞–≤–ª—è–ª —Ç–æ–ª—å–∫–æ —Ç–µ, —á—Ç–æ —É–ª—É—á—à–∞—é—Ç —Å–∫–æ—Ä)
* L1 regularization (Lasso)
* Permutation importance (–≤–∞–∂–Ω—ã–µ —Ñ–∏—á–∏ –∑–∞–º–µ—Ç–Ω–æ ‚Äú—Ä–æ–Ω—è—é—Ç‚Äù –º–µ—Ç—Ä–∏–∫—É –ø—Ä–∏ –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏–∏; —à—É–º–æ–≤—ã–µ ‚âà 0 –∏–ª–∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –≤–∫–ª–∞–¥)

**–í—ã—Ö–æ–¥—ã:**

* processed dataset ‚Üí `data/processed/`
* –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ñ–∏—á ‚Üí `artifacts/features.json`

---

### 2) –ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ + Optuna (XGBoost)

* –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–æ–¥–µ–ª–µ–π –∏ –≤—ã–±—Ä–∞–ª **XGBoost**
* —Å–¥–µ–ª–∞–ª sanity check: **shuffle target ‚Üí –æ–∂–∏–¥–∞–µ–º–æ ROC-AUC ‚âà 0.5**

  * –µ—Å–ª–∏ –º–µ—Ç—Ä–∏–∫–∞ –æ—Å—Ç–∞—ë—Ç—Å—è –≤—ã—Å–æ–∫–æ–π ‚Äî –≤–æ–∑–º–æ–∂–Ω—ã —É—Ç–µ—á–∫–∏/–±–∞–≥/–ø–µ—Ä–µ–ø–æ–¥–≥–æ–Ω
* Optuna tuning ‚Üí —Å–æ—Ö—Ä–∞–Ω–∏–ª –ª—É—á—à–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

---

### 3) Full Custom Pipeline (raw ‚Üí processed ‚Üí model)

‚Äú–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π‚Äù –ø–æ–¥—Ö–æ–¥ –æ–±—É—á–∞–ª –º–æ–¥–µ–ª—å —Ç–æ–ª—å–∫–æ –Ω–∞ —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (processed).
–í –ø—Ä–æ–µ–∫—Ç–µ —Ç–∞–∫–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω **full custom pipeline**, –∫–æ—Ç–æ—Ä—ã–π:

1. –ø—Ä–∏–Ω–∏–º–∞–µ—Ç raw –¥–∞–Ω–Ω—ã–µ
2. –¥–µ–ª–∞–µ—Ç feature engineering –≤–Ω—É—Ç—Ä–∏ –ø–∞–π–ø–ª–∞–π–Ω–∞
3. –æ–±—É—á–∞–µ—Ç –º–æ–¥–µ–ª—å –Ω–∞ –ª—É—á—à–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö –∏–∑ Optuna

–§–∞–π–ª—ã:

* `src/custom_pipeline.py` ‚Äî —Å–±–æ—Ä–∫–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞
* `src/train_custom.py` ‚Äî –æ–±—É—á–µ–Ω–∏–µ full pipeline
* `notebooks/03_check_pipelines_performance.ipynb` ‚Äî —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–æ–≤

---

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
# dev dependencies (optional)
pip install -r requirements-dev.txt
```

### –ó–∞–ø—É—Å–∫ Streamlit

```bash
streamlit run app.py
```

---

## üê≥ –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker

### Build

```bash
docker build -t titanic-streamlit .
```

### Run

```bash
docker run --rm -p 8501:8501 titanic-streamlit
```

### –ò–ª–∏ —á–µ—Ä–µ–∑ Docker Compose

```bash
docker compose up --build
```

–û—Ç–∫—Ä—ã—Ç—å:

* [http://localhost:8501](http://localhost:8501)

---

## üì¶ –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã

–•—Ä–∞–Ω—è—Ç—Å—è –≤ `artifacts/model_data/`:

* `best_params.json` ‚Äî –ª—É—á—à–∏–µ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã Optuna
* `best_score.json` ‚Äî –ª—É—á—à–∏–π objective score (–Ω–∞–ø—Ä–∏–º–µ—Ä, `best_roc_auc_value`)
* `threshold.json` ‚Äî `threshold_f1` (–ø–æ—Ä–æ–≥, –º–∞–∫—Å–∏–º–∏–∑–∏—Ä—É—é—â–∏–π F1; –Ω–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π 0.5)

–¢–∞–∫–∂–µ:

* `artifacts/features.json` ‚Äî —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä —Ñ–∏—á + –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ

---

## üõ£ Roadmap

*  –î–æ–±–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ Streamlit demo ‚Äî ```done```

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT ‚Äî —Å–º. `LICENSE`


